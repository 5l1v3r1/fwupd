From 708f49007500935e82dfd4561c56a7268e749e9f Mon Sep 17 00:00:00 2001
From: Mario Limonciello <mario.limonciello@dell.com>
Date: Sat, 30 Nov 2019 18:03:00 -0600
Subject: [PATCH 1/3] trivial: installed-tests: explicitly choose webcam device
 ID
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

In some CI infrastructures other devices show up and so the webcam
is not automatically picked.

```
Enabling fwupd-tests remote...
Successfully enabled remote
Update the device hash database...
Choose a device:
0.	Cancel
1.	08d460be0f1f9f128413f816022a6439e0078018 (Integrated Webcamâ„¢)
2.	bbbf1ce3d1cf15550c3760b354592040292415bb (Virtio network device)
Request canceled
FAIL: fwupd/fwupdmgr.test (Child process exited with code 2)
SUMMARY: total=1; passed=0; skipped=0; failed=1; user=0.0s; system=0.0s; maxrss=11736
FAIL: fwupd/fwupdmgr.test (Child process exited with code 2)
autopkgtest [22:09:32]: test ci: -----------------------]
ci                   FAIL non-zero exit status 2
autopkgtest [22:09:33]: test ci:  - - - - - - - - - - results - - - - - - - - - -
autopkgtest [22:09:33]: @@@@@@@@@@@@@@@@@@@@ summary
ci                   FAIL non-zero exit status 2
```
---
 data/installed-tests/fwupdmgr.sh | 11 ++++++-----
 1 file changed, 6 insertions(+), 5 deletions(-)

diff --git a/data/installed-tests/fwupdmgr.sh b/data/installed-tests/fwupdmgr.sh
index af7317c4..f9a419f8 100755
--- a/data/installed-tests/fwupdmgr.sh
+++ b/data/installed-tests/fwupdmgr.sh
@@ -2,6 +2,7 @@
 
 exec 2>&1
 dirname=`dirname $0`
+device=08d460be0f1f9f128413f816022a6439e0078018
 
 # ---
 echo "Getting the list of remotes..."
@@ -15,7 +16,7 @@ rc=$?; if [[ $rc != 0 ]]; then exit $rc; fi
 
 # ---
 echo "Update the device hash database..."
-fwupdmgr verify-update
+fwupdmgr verify-update $device
 rc=$?; if [[ $rc != 0 ]]; then exit $rc; fi
 
 # ---
@@ -25,7 +26,7 @@ rc=$?; if [[ $rc != 0 ]]; then exit $rc; fi
 
 # ---
 echo "Testing the verification of firmware..."
-fwupdmgr verify
+fwupdmgr verify $device
 rc=$?; if [[ $rc != 0 ]]; then exit $rc; fi
 
 # ---
@@ -45,17 +46,17 @@ rc=$?; if [[ $rc != 2 ]]; then exit $rc; fi
 
 # ---
 echo "Testing the verification of firmware (again)..."
-fwupdmgr verify
+fwupdmgr verify $device
 rc=$?; if [[ $rc != 0 ]]; then exit $rc; fi
 
 # ---
 echo "Downgrading to older release (requires network access)"
-fwupdmgr downgrade
+fwupdmgr downgrade $device
 rc=$?; if [[ $rc != 0 ]]; then exit $rc; fi
 
 # ---
 echo "Downgrading to older release (should be none)"
-fwupdmgr downgrade
+fwupdmgr downgrade $device
 rc=$?; if [[ $rc != 2 ]]; then exit $rc; fi
 
 # ---
-- 
2.20.1

