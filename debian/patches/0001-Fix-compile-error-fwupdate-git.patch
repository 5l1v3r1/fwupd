From 6fade1ffea19246987667a6acf35d9a6917693c9 Mon Sep 17 00:00:00 2001
From: Mario Limonciello <mario_limonciello@dell.com>
Date: Tue, 10 Nov 2015 18:13:48 -0600
Subject: [PATCH] Fix compile error against fwupdate git due to dropped
 functions.

Closes #37
---
 src/fu-provider-uefi.c | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

Index: fwupd/src/fu-provider-uefi.c
===================================================================
--- fwupd.orig/src/fu-provider-uefi.c	2015-11-12 10:14:33.666632745 -0600
+++ fwupd/src/fu-provider-uefi.c	2015-11-12 10:14:48.318632673 -0600
@@ -218,6 +218,7 @@
 	gboolean ret = TRUE;
 	guint64 hardware_instance = 0;	/* FIXME */
 	int fd;
+	int call;
 	const gchar *fn = "/boot/fwupd-efiupdate";
 
 	/* save the data to a temp file */
@@ -254,13 +255,14 @@
 	/* perform the update */
 	g_debug ("Performing UEFI capsule update");
 	fu_provider_set_status (provider, FWUPD_STATUS_SCHEDULING);
-	if (fwup_set_up_update (re, hardware_instance, fd) < 0) {
+	call = fwup_set_up_update (re, hardware_instance, fd);
+	if (call < 0) {
 		ret = FALSE;
 		g_set_error (error,
 			     FWUPD_ERROR,
 			     FWUPD_ERROR_NOT_SUPPORTED,
-			     "UEFI firmware update failed: %s",
-			     fwup_strerror (fwup_error));
+			     "UEFI firmware update failed: %d",
+			     call);
 		goto out;
 	}
 out:
